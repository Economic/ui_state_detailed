---
title: "Weekly UI initial claims by industry"
date: "Data updated April 15, 2020"
output:
  html_document:
    theme: flatly
---

```{r setup, include=FALSE}
library(knitr)
library(DT)
library(tidyverse)
library(lubridate)
library(scales)
opts_chunk$set(echo = FALSE)
```

```{r include=FALSE}
state_ui_industry_recoded <- read_csv("../output/state_ui_industry_recoded.csv") %>% 
  transmute(
    State = stateabb,
    `Week ending` = paste(sprintf("%02d", month(endweek)), sprintf("%02d", day(endweek)), sep = "-"),
    `Sector name` = sectorname,
    NAICS = sector,
    `Initial claims (IC)` = number(ic, accuracy = 1.0, big.mark = ","),
    `Total state IC` = number(ic_headline, accuracy = 1.0, big.mark = ","),
    `IC share of state IC` = percent(ic_share_sumic, accuracy = 0.1)
  ) %>% 
  arrange(State, `Week ending`, NAICS)

state_ui_industry_original <- read_csv("../output/state_ui_industry_original.csv") %>% 
  transmute(
    State = stateabb,
    `Week ending` = paste(sprintf("%02d", month(endweek)), sprintf("%02d", day(endweek)), sep = "-"),
    `Sector name` = sectorname,
    NAICS = sector,
    `Initial claims (IC)` = number(ic, accuracy = 1.0, big.mark = ",")
  ) %>% 
  arrange(State, `Week ending`, NAICS)

ui_data_summary <- read_csv("../output/ui_data_summary.csv") %>% 
  transmute(
    State = stateabb,
    `First week ending` = minweek,
    `Last week ending` = maxweek,
    `Industries available` = desc
  )
```

## Available data
```{r}
datatable(
  ui_data_summary,
  rownames = FALSE,
  options = list(
    dom = 'rt',
    columnDefs = list(
      list(className = 'dt-right', targets = 0:3)
    ),
    scrollY = "800px",
    scrollCollapse = TRUE,
    paging = FALSE
  )
)
```

## Original data
This is data as reported from the sources below, with minimal re-coding.
```{r}
datatable(
  state_ui_industry_original,
  rownames = FALSE,
  extensions = 'Buttons',
  options = list(
    dom = 'Brt',
    buttons = list(list(extend = 'csv', filename= 'state_ui_industry_original')),
    columnDefs = list(
      list(className = 'dt-right', targets = 0:4)
    ),
    scroller = TRUE,
    scrollX = TRUE,
    scrollY = "400px",
    scrollCollapse = TRUE,
    paging = FALSE
  )
)
```

## Adjusted data
This data takes the above and removes unclassified sectors and then scales IC totals to match the totals that states report weekly to the US DOL.
```{r}
datatable(
  state_ui_industry_recoded,
  rownames = FALSE,
  extensions = 'Buttons',
  options = list(
    dom = 'Brt',
    buttons = list(list(extend = 'csv', filename= 'state_ui_industry_recoded')),
    columnDefs = list(
      list(className = 'dt-right', targets = 0:5),
      list(width = "10%", targets = 0),
      list(width = "15%", targets = 1),
      list(width = "40%", targets = 2)
    ),
    scroller = TRUE,
    scrollX = TRUE,
    scrollY = "400px",
    scrollCollapse = TRUE,
    paging = FALSE
  )
)
```

## Sources
The data are from state employment offices for most states; Michigan's data is from the [W.E. Upjohn Institute](https://www.upjohn.org/research-highlights), which collected data from that state's employment office.

To do: list of state data sources.

See the Github [repo](https://github.com/Economic/ui_state_detailed) for the code.

## Contributors
Jori Kandra, Andrew Van Dam, Ben Zipperer
